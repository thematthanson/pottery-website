(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}})();window.onload=function(){emailjs.init({publicKey:void 0}),console.log("EmailJS initialized")};class h{constructor(t=0,r="Network Error"){this.status=t,this.text=r}}const E=()=>{if(!(typeof localStorage>"u"))return{get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,t)=>Promise.resolve(localStorage.setItem(e,t)),remove:e=>Promise.resolve(localStorage.removeItem(e))}},n={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:E()},y=e=>e?typeof e=="string"?{publicKey:e}:e.toString()==="[object Object]"?e:{}:{},$=(e,t="https://api.emailjs.com")=>{if(!e)return;const r=y(e);n.publicKey=r.publicKey,n.blockHeadless=r.blockHeadless,n.storageProvider=r.storageProvider,n.blockList=r.blockList,n.limitRate=r.limitRate,n.origin=r.origin||t},b=async(e,t,r={})=>{const s=await fetch(n.origin+e,{method:"POST",headers:r,body:t}),o=await s.text(),i=new h(s.status,o);if(s.ok)return i;throw i},w=(e,t,r)=>{if(!e||typeof e!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!t||typeof t!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!r||typeof r!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},F=e=>{if(e&&e.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},v=e=>e.webdriver||!e.languages||e.languages.length===0,P=()=>new h(451,"Unavailable For Headless Browser"),I=(e,t)=>{if(!Array.isArray(e))throw"The BlockList list has to be an array";if(typeof t!="string")throw"The BlockList watchVariable has to be a string"},H=e=>{var t;return!((t=e.list)!=null&&t.length)||!e.watchVariable},O=(e,t)=>e instanceof FormData?e.get(t):e[t],S=(e,t)=>{if(H(e))return!1;I(e.list,e.watchVariable);const r=O(t,e.watchVariable);return typeof r!="string"?!1:e.list.includes(r)},L=()=>new h(403,"Forbidden"),R=(e,t)=>{if(typeof e!="number"||e<0)throw"The LimitRate throttle has to be a positive number";if(t&&typeof t!="string")throw"The LimitRate ID has to be a non-empty string"},K=async(e,t,r)=>{const s=Number(await r.get(e)||0);return t-Date.now()+s},k=async(e,t,r)=>{if(!t.throttle||!r)return!1;R(t.throttle,t.id);const s=t.id||e;return await K(s,t.throttle,r)>0?!0:(await r.set(s,Date.now().toString()),!1)},T=()=>new h(429,"Too Many Requests"),M=async(e,t,r,s)=>{const o=y(s),i=o.publicKey||n.publicKey,a=o.blockHeadless||n.blockHeadless,l=o.storageProvider||n.storageProvider,c={...n.blockList,...o.blockList},u={...n.limitRate,...o.limitRate};return a&&v(navigator)?Promise.reject(P()):(w(i,e,t),F(r),r&&S(c,r)?Promise.reject(L()):await k(location.pathname,u,l)?Promise.reject(T()):b("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:i,service_id:e,template_id:t,template_params:r}),{"Content-type":"application/json"}))},_=e=>{if(!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"},B=e=>typeof e=="string"?document.querySelector(e):e,D=async(e,t,r,s)=>{const o=y(s),i=o.publicKey||n.publicKey,a=o.blockHeadless||n.blockHeadless,l=n.storageProvider||o.storageProvider,c={...n.blockList,...o.blockList},u={...n.limitRate,...o.limitRate};if(a&&v(navigator))return Promise.reject(P());const f=B(r);w(i,e,t),_(f);const d=new FormData(f);return S(c,d)?Promise.reject(L()):await k(location.pathname,u,l)?Promise.reject(T()):(d.append("lib_version","4.4.1"),d.append("service_id",e),d.append("template_id",t),d.append("user_id",i),b("/api/v1.0/email/send-form",d))},N={init:$,send:M,sendForm:D,EmailJSResponseStatus:h},q="https://script.google.com/macros/s/AKfycbwRrP7dfNH59F5O8EV-_jS99WSxhpjb9tYmwF2wx9o6ZNp6ntX18w1Fx-dhe_9lhEam/exec";N.init({publicKey:void 0});let m=[];document.addEventListener("DOMContentLoaded",async()=>{try{throw new Error("Google Sheets API Key or Spreadsheet ID is not defined.")}catch(e){console.error("Error initializing data:",e)}});async function V(e,t,r){try{const s=`https://sheets.googleapis.com/v4/spreadsheets/${t}/values/${r}?key=${e}`,o=await fetch(s);if(!o.ok)throw new Error(`HTTP error! Status: ${o.status}`);const i=await o.json();return!i.values||!Array.isArray(i.values)?(console.error("Invalid data format:",i),[]):i.values}catch(s){throw console.error("Error fetching data:",s),s}}function x(e){const t=document.getElementById("pottery-grid");if(!t){console.error("Pottery grid element not found");return}t.innerHTML="",e.forEach(([r,s,o,i,a,l,c,u,f,d])=>{const p=(c==null?void 0:c.toLowerCase())==="taken",g=document.createElement("div");g.className=`card ${p?"taken":""} bg-[#FFFBF5]`,g.innerHTML=`
            <figure>
                <img 
                    src="${s}" 
                    alt="Piece ${r}" 
                    class="w-full h-auto object-cover rounded-[15px] ${p?"grayscale":""}"
                    ${p?"":`onmouseover="this.src='${f}'" onmouseout="this.src='${s}'"`}
                    onerror="this.onerror=null; this.src='/pottery-website/assets/images/fallback-image.jpg';">
            </figure>
            <div class="p-4">
                <h2 class="text-xl font-semibold mb-2">Piece ${r}</h2>
                <p class="text-gray-600 mb-2">${l||"No description available"}</p>
                <p class="text-gray-600 mb-4">Size: ${o||0} x ${i||0} x ${a||0}</p>
                <button class="btn btn-primary w-full" 
                        ${p?"disabled":""}
                        onclick="openModal('${r}')">
                    ${p?"Taken":"Select"}
                </button>
            </div>
        `,t.appendChild(g)})}function A(e){const t=document.getElementById("pottery-modal");if(!t){console.error("Modal element not found");return}const r=t.querySelector("form"),s=r.querySelector('input[name="pottery_id"]');if(!r||!s){console.error("Form or pottery ID input not found in modal");return}r.reset(),s.value=e;const o=m.find(u=>u[0]===e);if(!o){console.error("Pottery item not found for ID:",e);return}const[i,a,,,,,,,,l]=o,c=document.getElementById("modal-images");c&&(c.innerHTML=`
            <div class="flex flex-col items-center">
                <div class="image-container">
                    <img src="${a}" alt="Side view" class="modal-image">
                </div>
                <p class="text-sm text-gray-600 mt-2">Side view</p>
            </div>
            <div class="flex flex-col items-center">
                <div class="image-container">
                    <img src="${l}" alt="Top view" class="modal-image">
                </div>
                <p class="text-sm text-gray-600 mt-2">Top view</p>
            </div>
        `),t.showModal()}function j(){const e=document.getElementById("pottery-modal");e&&e.close()}async function C(e,t){try{const s=await(await fetch(q,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({potteryId:e,userName:t})})).json();if(!s.success)throw new Error(s.error);console.log("Google Sheet updated successfully:",s.message)}catch(r){throw console.error("Error updating Google Sheets:",r),new Error("Failed to update Google Sheets")}}function G(e){const t=m.findIndex(r=>r[0]===e);t!==-1?(m[t][6]="taken",x(m)):console.error("Pottery ID not found in local data")}document.getElementById("order-form").addEventListener("submit",async function(e){e.preventDefault();const t=this,r=t.querySelector('button[type="submit"]'),s=r.querySelector(".normal-text"),o=r.querySelector(".loading-text"),i=new FormData(t),a=i.get("pottery_id"),l=i.get("user_name");try{r.disabled=!0,s.classList.add("hidden"),o.classList.remove("hidden"),await C(a,l),G(a),alert(`Thank you for ordering Piece ${a}!`),j()}catch(c){console.error("Order submission error:",c),alert(`Failed to submit the order: ${c.message}`)}finally{r.disabled=!1,s.classList.remove("hidden"),o.classList.add("hidden")}});window.openModal=A;window.closeModal=j;
