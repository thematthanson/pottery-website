(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(o){if(o.ep)return;o.ep=!0;const s=r(o);fetch(o.href,s)}})();window.onload=function(){emailjs.init({publicKey:void 0}),console.log("EmailJS initialized")};class g{constructor(t=0,r="Network Error"){this.status=t,this.text=r}}const I=()=>{if(!(typeof localStorage>"u"))return{get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,t)=>Promise.resolve(localStorage.setItem(e,t)),remove:e=>Promise.resolve(localStorage.removeItem(e))}},a={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:I()},b=e=>e?typeof e=="string"?{publicKey:e}:e.toString()==="[object Object]"?e:{}:{},_=(e,t="https://api.emailjs.com")=>{if(!e)return;const r=b(e);a.publicKey=r.publicKey,a.blockHeadless=r.blockHeadless,a.storageProvider=r.storageProvider,a.blockList=r.blockList,a.limitRate=r.limitRate,a.origin=r.origin||t},w=async(e,t,r={})=>{const n=await fetch(a.origin+e,{method:"POST",headers:r,body:t}),o=await n.text(),s=new g(n.status,o);if(n.ok)return s;throw s},v=(e,t,r)=>{if(!e||typeof e!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!t||typeof t!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!r||typeof r!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},j=e=>{if(e&&e.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},P=e=>e.webdriver||!e.languages||e.languages.length===0,L=()=>new g(451,"Unavailable For Headless Browser"),F=(e,t)=>{if(!Array.isArray(e))throw"The BlockList list has to be an array";if(typeof t!="string")throw"The BlockList watchVariable has to be a string"},H=e=>{var t;return!((t=e.list)!=null&&t.length)||!e.watchVariable},M=(e,t)=>e instanceof FormData?e.get(t):e[t],S=(e,t)=>{if(H(e))return!1;F(e.list,e.watchVariable);const r=M(t,e.watchVariable);return typeof r!="string"?!1:e.list.includes(r)},k=()=>new g(403,"Forbidden"),O=(e,t)=>{if(typeof e!="number"||e<0)throw"The LimitRate throttle has to be a positive number";if(t&&typeof t!="string")throw"The LimitRate ID has to be a non-empty string"},R=async(e,t,r)=>{const n=Number(await r.get(e)||0);return t-Date.now()+n},T=async(e,t,r)=>{if(!t.throttle||!r)return!1;O(t.throttle,t.id);const n=t.id||e;return await R(n,t.throttle,r)>0?!0:(await r.set(n,Date.now().toString()),!1)},x=()=>new g(429,"Too Many Requests"),K=async(e,t,r,n)=>{const o=b(n),s=o.publicKey||a.publicKey,i=o.blockHeadless||a.blockHeadless,c=o.storageProvider||a.storageProvider,l={...a.blockList,...o.blockList},m={...a.limitRate,...o.limitRate};return i&&P(navigator)?Promise.reject(L()):(v(s,e,t),j(r),r&&S(l,r)?Promise.reject(k()):await T(location.pathname,m,c)?Promise.reject(x()):w("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:s,service_id:e,template_id:t,template_params:r}),{"Content-type":"application/json"}))},B=e=>{if(!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"},D=e=>typeof e=="string"?document.querySelector(e):e,q=async(e,t,r,n)=>{const o=b(n),s=o.publicKey||a.publicKey,i=o.blockHeadless||a.blockHeadless,c=a.storageProvider||o.storageProvider,l={...a.blockList,...o.blockList},m={...a.limitRate,...o.limitRate};if(i&&P(navigator))return Promise.reject(L());const u=D(r);v(s,e,t),B(u);const d=new FormData(u);return S(l,d)?Promise.reject(k()):await T(location.pathname,m,c)?Promise.reject(x()):(d.append("lib_version","4.4.1"),d.append("service_id",e),d.append("template_id",t),d.append("user_id",s),w("/api/v1.0/email/send-form",d))},h={init:_,send:K,sendForm:q,EmailJSResponseStatus:g},A="https://script.google.com/macros/s/AKfycbxJlyW8nblHwZu-T7wIqxrVvnnwnM1OKi9ISxo--sf820OWfy7FI5-Gofk2uYyAXPgJ/exec";h.init({publicKey:void 0});let f=[];document.addEventListener("DOMContentLoaded",async()=>{try{throw new Error("Google Sheets API Key or Spreadsheet ID is not defined.")}catch(e){console.error("Error initializing data:",e)}});async function N(e,t,r){try{const n=`https://sheets.googleapis.com/v4/spreadsheets/${t}/values/${r}?key=${e}`,o=await fetch(n);if(!o.ok)throw new Error(`HTTP error! Status: ${o.status}`);const s=await o.json();return!s.values||!Array.isArray(s.values)?(console.error("Invalid data format:",s),[]):s.values}catch(n){throw console.error("Error fetching data:",n),n}}function E(e){const t=document.getElementById("pottery-grid");if(!t){console.error("Pottery grid element not found");return}t.innerHTML="",e.forEach(([r,n,o,s,i,c,l,m,u,d])=>{const p=(l==null?void 0:l.toLowerCase())==="taken",y=document.createElement("div");y.className=`card ${p?"taken":""} bg-[#FFFBF5]`,y.innerHTML=`
      <figure>
        <img 
          src="${n}" 
          alt="Piece ${r}" 
          class="w-full h-auto object-cover rounded-[15px] ${p?"grayscale":""}"
          ${p?"":`onmouseover="this.src='${u}'" onmouseout="this.src='${n}'"`}
          onerror="this.onerror=null; this.src='/pottery-website/assets/images/fallback-image.jpg';">
      </figure>
      <div class="p-4">
        <h2 class="text-xl font-semibold mb-2">Piece ${r}</h2>
        <p class="text-gray-600 mb-2">${c||"No description available"}</p>
        <p class="text-gray-600 mb-4">Size: ${o||0} x ${s||0} x ${i||0}</p>
        <button class="btn btn-primary w-full" 
                ${p?"disabled":""}
                onclick="openModal('${r}')">
          ${p?"Taken":"Select"}
        </button>
      </div>
    `,t.appendChild(y)})}function V(e){const t=document.getElementById("pottery-modal");if(!t){console.error("Modal element not found");return}const r=t.querySelector("form"),n=r.querySelector('input[name="pottery_id"]');if(!r||!n){console.error("Form or pottery ID input not found in modal");return}r.reset(),n.value=e;const o=f.find(m=>m[0]===e);if(!o){console.error("Pottery item not found for ID:",e);return}const[s,i,,,,,,,,c]=o,l=document.getElementById("modal-images");l&&(l.innerHTML=`
      <div class="flex flex-col items-center">
        <img src="${i}" alt="Side view" class="modal-image rounded-[15px]">
        <p class="text-sm text-gray-600 mt-2">Side view</p>
      </div>
      <div class="flex flex-col items-center">
        <img src="${c}" alt="Top view" class="modal-image rounded-[15px]">
        <p class="text-sm text-gray-600 mt-2">Top view</p>
      </div>
    `),t.showModal()}function $(){const e=document.getElementById("pottery-modal");e&&e.close()}async function C(e){try{const t=await fetch(A,{method:"POST",mode:"no-cors",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify({potteryId:e})});return{success:!0}}catch(t){throw console.error("Error updating Google Sheets:",t),new Error("Failed to update Google Sheets")}}function G(e){const t=f.findIndex(r=>r[0]===e);t!==-1?(f[t][6]="taken",E(f)):console.error("Pottery ID not found in local data")}document.getElementById("order-form").addEventListener("submit",async function(e){e.preventDefault();const t=this,r=t.querySelector('button[type="submit"]'),n=r.querySelector(".normal-text"),o=r.querySelector(".loading-text"),s=new FormData(t),i=s.get("pottery_id");try{r.disabled=!0,r.classList.add("opacity-50"),n.classList.add("hidden"),o.classList.remove("hidden");const c=f.find(d=>d[0]===i);if(!c)throw new Error("Pottery not found");const l={to_name:s.get("user_name"),user_name:s.get("user_name"),user_email:s.get("user_email"),user_address:s.get("user_address"),pottery_id:i,pottery_details:c[5]||"No description available"};console.log("Starting email sending process..."),console.log("Sending admin email...");let m;try{m=await h.send(void 0,void 0,{...l,to_name:"Matt"}),console.log("Admin email sent:",m.status)}catch(d){throw console.error("Admin email error:",d),new Error("Failed to send admin notification")}console.log("Sending customer email...");let u;try{u=await h.send(void 0,void 0,{...l,to_email:s.get("user_email")}),console.log("Customer email sent:",u.status)}catch(d){throw console.error("Customer email error:",d),new Error("Failed to send customer confirmation")}await C(i),G(i),alert(`Thank you for ordering Piece ${i}! A confirmation email has been sent to ${s.get("user_email")}`),$()}catch(c){console.error("Order submission error:",c),alert(`Failed to submit the order: ${c.message}`)}finally{r.disabled=!1,r.classList.remove("opacity-50"),n.classList.remove("hidden"),o.classList.add("hidden")}});window.openModal=V;window.closeModal=$;
